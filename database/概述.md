[toc]

# 2. 
## E-R模型
属性：
- 
联系：
- 实体集的映射关系(二元以及多元)
- 单个实体集内部的联系: 班长
- 多个: 工厂,产品, 用户
- 相同实体的多种联系: 职工的上下级和同事关系
- 联系不一定都是满射
- 联系本身的属性: 学习关系 $\rightarrow$ (学生 课程 成绩), (借阅: 书, 学生, 归还日期)
属性的描述:
- 属性名, 域
实体:
- 元组: 各属性值的集合 tuple
- 关键字属性: 工号, 身份证号等可以唯一确定实体的属性 $\rightarrow$ 主关键字, 候选关键字
联系:
- 
E-R图
- 属性不能单独存在
- 线段两端注明对应关系 : 1:1, 1:m
- 建模:
	- 需要进一步描述多方面的信息, 可以持久的存在: 实体
	- 单一的描述值: 属性 联系的属性会随着联系的消失而消失
	- 与多个对象有关: 联系
	- 多元联系可以用多个二元联系来表示
## EER模型

-  IS-A联系
- 超实体集- 子实体集(子集的实体包含的属性更多)
- 弱实体集: 如家属, 家长 $\rightarrow$ 一般是多对一, 要依附于其他实体存在 到联系的有向箭头
关系模型:
	- 数据操纵: 一张表对多张表的查询
- 二维表的关系
	- 同一表中属性名不同
	- 表中的元组均不相同
	- 排列次序无关
	- 每一分量都是不可分割的基本数据项 $\rightarrow$ 不可再分割
	- 每一个关系都有关键字

## 关系数据库
- 二维表
	- 结构简单
	- 使用方便：不涉及物理结构，非过程性数据子语言(封装较好）
	- 功能较强：方便修改，存取路径灵活，
	- 独立性高：不涉及物理因素
	![输入图片说明](/imgs/2024-03-11/p7LsbamoZXb8gr7f.png)
	- 元组唯一，但是实现时可以重复
	- 外键的两张表可以重合，外键可以为空但是不能不存在
	- 两个外键可以联合构成候选键
	- 外键可以引用自身
	![输入图片说明](/imgs/2024-03-20/HSw7IGkkUTZPOihW.png)
	


	![输入图片说明](/imgs/2024-03-20/LkA4Gm9ZcuQrIPCE.png)
	**关系操纵**
	- 查询
		- 单张： 纵向定位，横向定位
		- 多张表的数据查询：先合并成一张表，再进行查询
	- 增加
	- 删除：不能跨表删除
	- 修改：先删除再插入
	**空值**
	- 主键不能是空值
	- 运算中出现，结果就是空值
	- 逻辑运算中就为假
	- 统计计算中
		- 空集做sum, avg, max, min操作时结果为空
		- count操作时统计结果为0，
	- 投影时重复的元组会合并
		![111](/imgs/2024-03-11/2q2CeZNm0KnxlxNz.png)
		$\Pi_{c.name,c.city,a.name} \sigma_{c.city=a.city}(R*C)$
- 笛卡尔乘积时要进行换名

- 除法运算中会进行合并操作
![输入图片说明](/imgs/2024-03-18/mFRIvcelMYkEztt9.png)
则需要先把有关系的列单独投影出来

**联结**
- 外联结就是将无法联结的内容补充到表中，剩余值用null代替
- 联结时遇到可能存在重复的值要慎重考虑，可能会漏选情况

## SQL语言
- distinct 只在select中可以使用，用于删除重复的数据

- 注意，视图并不存在与数据库中，只保留了构造信息 

![输入图片说明](/imgs/2024-04-01/DipM7JKexJWlEPcj.png)

- 修改例如平均值这样的属性是不被允许的
- WITH CHECK OPTION表示对视图进行UPDATE、INSERT和DELETE操作时，要保证更新、插入或删除的行满足视图定义中的谓词条件（即子查询中的条件表达式）

## 事务的性质
**原子性**
**一致性**
开始和结束时数据库都要处于一致的状态
**隔离性**
**持久性**：redo（重做）日志
![ACID](/imgs/2024-04-08/lvJfwadiNpj8IcO2.png)
死锁：两个文件相互访问对方的数据

- 不可重复是针对记录的更新操作，只要在记录上加写锁，就可避免；幻读是对记录的插入操作，要禁止幻读必须加上全局的写锁（比如在表上加写锁）。
- 并发控制仅考虑事务要访问的元组是不够的，还需要考虑事务用于找到待访问元组的信息。

<!--stackedit_data:
eyJoaXN0b3J5IjpbMzU3MzgyMDcwLDM0ODQzNzY3NCw3ODc0OT
MzOCwtMTQ4NjU4ODk1MiwtNDExOTYxNzIxLC0xNDAwMzU4MTAx
LC0xMjMxNDc2MDc0LDMwNDI5MTU3MywxOTg0NTAzNzAwLC0yNz
Y3NDg3MjUsNjkxNDg3ODg5LC0yMTcyMTA5NjgsLTQ1NjA3ODcx
MiwtMjg5MTY3ODEwLDE3NTMyMDc3ODAsMzI1OTk1NTE2LDYyMD
g4NzY4OCwtMTIxMDgwNjM0NSw5MDI0OTM4MzEsMTMwMDgwNTQ4
Ml19
-->